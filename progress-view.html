<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VISIOR — Trial Progress</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { font-family: 'DM Sans', sans-serif; background: #f4f7fc; color: #1a2035; }
  .header { background: white; border-bottom: 1px solid #e2e6f0; padding: 0 32px; height: 64px; display: flex; align-items: center; justify-content: space-between; }
  .logo { display: flex; align-items: center; gap: 10px; text-decoration: none; cursor: pointer; }
  .logo-icon { width: 36px; height: 36px; background: linear-gradient(135deg, #4567B7, #334e96); border-radius: 9px; display: flex; align-items: center; justify-content: center; }
  .main { max-width: 1200px; margin: 40px auto; padding: 0 32px; }
  .back-btn { display: inline-flex; align-items: center; gap: 6px; padding: 8px 16px; border: 1px solid #e2e6f0; border-radius: 6px; background: white; cursor: pointer; margin-bottom: 24px; }
  .progress-container { background: white; border-radius: 12px; border: 1px solid #e2e6f0; padding: 32px; }
  .stats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin: 32px 0; }
  .stat-card { background: #f8fafc; padding: 20px; border-radius: 8px; text-align: center; }
  .stat-value { font-size: 32px; font-weight: 700; color: #4567B7; }
  .stat-label { color: #8b94b0; font-size: 12px; margin-top: 4px; }
  .chart-container { height: 400px; margin: 32px 0; }
  .footer-links { display: flex; justify-content: center; gap: 16px; margin-top: 40px; padding: 20px 0; border-top: 1px solid #e2e6f0; }
</style>
</head>
<body>
<header class="header">
  <div class="logo" onclick="window.location.href='home.html'">
    <div class="logo-icon">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5">
        <path d="M12 2L4 6v6c0 5.25 3.5 10.15 8 11.5C16.5 22.15 20 17.25 20 12V6L12 2z"/>
      </svg>
    </div>
    <div><strong style="color: #4567B7;">VISIOR</strong> <span style="font-size:10px;">PROGRESS</span></div>
  </div>
</header>

<div class="main">
  <button class="back-btn" onclick="window.location.href='pi-dashboard.html'">← Back to Dashboard</button>
  
  <div class="progress-container">
    <h1 id="trial-title">CARDIOPROTECT-II Progress</h1>
    <p style="color: #8b94b0;" id="trial-id">VISIOR-2024-003</p>

    <div class="stats-grid">
      <div class="stat-card"><div class="stat-value" id="enrolled">342</div><div class="stat-label">Enrolled</div></div>
      <div class="stat-card"><div class="stat-value" id="target">500</div><div class="stat-label">Target</div></div>
      <div class="stat-card"><div class="stat-value" id="completion">68%</div><div class="stat-label">Completion</div></div>
      <div class="stat-card"><div class="stat-value" id="sae">3</div><div class="stat-label">SAE Events</div></div>
    </div>

    <div class="chart-container">
      <canvas id="enrollmentChart"></canvas>
    </div>

    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 32px;">
      <div style="background: #f8fafc; padding: 20px; border-radius: 8px;">
        <h3>Demographics</h3>
        <canvas id="demographicsChart" style="height:200px; margin-top:16px;"></canvas>
      </div>
      <div style="background: #f8fafc; padding: 20px; border-radius: 8px;">
        <h3>Outcomes</h3>
        <canvas id="outcomesChart" style="height:200px; margin-top:16px;"></canvas>
      </div>
    </div>
  </div>

  <div class="footer-links">
    <a href="home.html">Home</a> <a href="help.html">Help</a> <a href="privacy.html">Privacy</a> <a href="terms.html">Terms</a>
  </div>
</div>

<script>
  const urlParams = new URLSearchParams(window.location.search);
  const trial = urlParams.get('trial') || 'VISIOR-2024-003';
  
  if(trial === 'VISIOR-2024-003') {
    document.getElementById('trial-title').textContent = 'CARDIOPROTECT-II Progress';
    document.getElementById('trial-id').textContent = 'VISIOR-2024-003';
    document.getElementById('enrolled').textContent = '342';
    document.getElementById('target').textContent = '500';
    document.getElementById('completion').textContent = '68%';
    document.getElementById('sae').textContent = '3';
  } else if(trial === 'VISIOR-2024-011') {
    document.getElementById('trial-title').textContent = 'NEURO-RESTORE Progress';
    document.getElementById('trial-id').textContent = 'VISIOR-2024-011';
    document.getElementById('enrolled').textContent = '88';
    document.getElementById('target').textContent = '300';
    document.getElementById('completion').textContent = '29%';
    document.getElementById('sae').textContent = '0';
  }

  new Chart(document.getElementById('enrollmentChart'), {
    type: 'line',
    data: {
      labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep'],
      datasets: [{
        label: 'Enrollment',
        data: [45, 78, 112, 156, 198, 245, 289, 320, 342],
        borderColor: '#4567B7',
        backgroundColor: 'rgba(69,103,183,0.1)',
        tension: 0.4,
        fill: true
      }]
    },
    options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } }
  });

  new Chart(document.getElementById('demographicsChart'), {
    type: 'doughnut',
    data: {
      labels: ['18-34', '35-54', '55-69', '70+'],
      datasets: [{
        data: [12, 38, 33, 17],
        backgroundColor: ['#4567B7', '#6b89d4', '#93adf0', '#b8c9ff']
      }]
    },
    options: { responsive: true, maintainAspectRatio: false }
  });

  new Chart(document.getElementById('outcomesChart'), {
    type: 'bar',
    data: {
      labels: ['Improved', 'Stable', 'Adverse'],
      datasets: [{
        data: [45, 35, 20],
        backgroundColor: ['#22c55e', '#f59e0b', '#ef4444']
      }]
    },
    options: { responsive: true, maintainAspectRatio: false }
  });
</script>
</body>
</html>