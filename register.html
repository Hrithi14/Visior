<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>WISER ‚Äî Create Account</title>
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;600;700;800&family=DM+Mono:wght@400;500&family=Sora:wght@400;600;700;800&display=swap" rel="stylesheet" />
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  html, body { height: 100%; width: 100%; font-family: 'DM Sans', sans-serif; background: linear-gradient(135deg, #f4f7fc 0%, #e9eef8 100%); }
  
  #app {
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 24px;
  }

  .register-container {
    max-width: 1100px;
    width: 100%;
    display: grid;
    grid-template-columns: 1fr 1fr;
    background: white;
    border-radius: 24px;
    box-shadow: 0 20px 60px rgba(69,103,183,0.2);
    overflow: hidden;
    animation: fadeUp 0.6s ease;
  }

  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .brand-panel {
    background: linear-gradient(145deg, #0f172a 0%, #1e3a6e 50%, #4567B7 100%);
    padding: 48px 40px;
    position: relative;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
  }

  .brand-panel::before {
    content: '';
    position: absolute;
    top: -80px;
    right: -80px;
    width: 320px;
    height: 320px;
    border-radius: 50%;
    background: rgba(255,255,255,0.05);
    pointer-events: none;
  }

  .brand-panel::after {
    content: '';
    position: absolute;
    bottom: -60px;
    left: -60px;
    width: 240px;
    height: 240px;
    border-radius: 50%;
    background: rgba(255,255,255,0.03);
    pointer-events: none;
  }

  .brand-logo {
    display: flex;
    align-items: center;
    gap: 12px;
    position: relative;
    z-index: 1;
    cursor: pointer;
  }

  .brand-logo-icon {
    width: 48px;
    height: 48px;
    background: rgba(255,255,255,0.1);
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 1px solid rgba(255,255,255,0.2);
  }

  .brand-logo-text h2 {
    font-family: 'Sora', sans-serif;
    font-size: 24px;
    font-weight: 700;
    color: white;
    letter-spacing: -0.5px;
  }

  .brand-logo-text p {
    font-size: 11px;
    color: rgba(255,255,255,0.5);
    letter-spacing: 1px;
    text-transform: uppercase;
    margin-top: 2px;
  }

  .brand-content {
    position: relative;
    z-index: 1;
    margin: 40px 0;
  }

  .brand-badge {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    background: rgba(255,255,255,0.1);
    border: 1px solid rgba(255,255,255,0.15);
    border-radius: 100px;
    padding: 8px 16px;
    margin-bottom: 24px;
  }

  .brand-badge span {
    font-size: 12px;
    font-weight: 600;
    color: white;
    letter-spacing: 0.5px;
  }

  .brand-badge-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: #22c55e;
    animation: pulse 2s infinite;
  }

  @keyframes pulse {
    0%,100% { opacity: 1; box-shadow: 0 0 0 0 rgba(34,197,94,0.4); }
    50% { opacity: 0.8; box-shadow: 0 0 0 5px rgba(34,197,94,0); }
  }

  .brand-title {
    font-size: 32px;
    font-weight: 800;
    color: white;
    line-height: 1.2;
    margin-bottom: 20px;
    font-family: 'Sora', sans-serif;
  }

  .brand-features {
    display: flex;
    flex-direction: column;
    gap: 16px;
  }

  .brand-feature {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 16px;
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 12px;
  }

  .feature-icon {
    width: 32px;
    height: 32px;
    background: rgba(69,103,183,0.3);
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
  }

  .feature-text {
    color: white;
  }

  .feature-text strong {
    font-size: 14px;
    font-weight: 600;
    display: block;
    margin-bottom: 2px;
  }

  .feature-text span {
    font-size: 11px;
    color: rgba(255,255,255,0.6);
  }

  .brand-footer {
    position: relative;
    z-index: 1;
    color: rgba(255,255,255,0.4);
    font-size: 12px;
    display: flex;
    gap: 24px;
  }

  .form-panel {
    padding: 48px 40px;
    background: white;
  }

  .form-header {
    margin-bottom: 32px;
  }

  .form-header h1 {
    font-family: 'Sora', sans-serif;
    font-size: 28px;
    font-weight: 700;
    color: #1a2240;
    margin-bottom: 8px;
  }

  .form-header p {
    font-size: 14px;
    color: #6b7280;
  }

  .form-header a {
    color: #4567B7;
    text-decoration: none;
    font-weight: 600;
  }

  .form-header a:hover {
    text-decoration: underline;
  }

  .error-banner {
    background: #fef2f2;
    border: 1px solid #fecaca;
    border-radius: 8px;
    padding: 12px 16px;
    margin-bottom: 24px;
    color: #dc2626;
    font-size: 13px;
    display: none;
    align-items: center;
    gap: 8px;
  }

  .error-banner.visible {
    display: flex;
  }

  .form-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px;
    margin-bottom: 16px;
  }

  .form-group {
    margin-bottom: 20px;
  }

  .form-group.full-width {
    grid-column: 1 / -1;
  }

  .form-group label {
    display: block;
    font-size: 12px;
    font-weight: 600;
    color: #374151;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 6px;
  }

  .form-group label .required {
    color: #ef4444;
  }

  .input-wrapper {
    position: relative;
  }

  .input-wrapper i {
    position: absolute;
    left: 14px;
    top: 50%;
    transform: translateY(-50%);
    color: #9ca3af;
    font-size: 16px;
    font-style: normal;
  }

  .input-wrapper input,
  .input-wrapper select {
    width: 100%;
    padding: 12px 16px 12px 44px;
    border: 1.5px solid #e5e7eb;
    border-radius: 10px;
    font-size: 14px;
    font-family: 'DM Sans', sans-serif;
    color: #1f2937;
    background: #f9fafb;
    transition: all 0.2s;
    outline: none;
  }

  .input-wrapper input:focus,
  .input-wrapper select:focus {
    border-color: #4567B7;
    background: white;
    box-shadow: 0 0 0 3px rgba(69,103,183,0.1);
  }

  .input-wrapper input.has-error {
    border-color: #ef4444;
  }

  .toggle-password {
    position: absolute;
    right: 14px;
    top: 50%;
    transform: translateY(-50%);
    background: none;
    border: none;
    cursor: pointer;
    color: #9ca3af;
    padding: 0;
    display: flex;
  }

  .field-error {
    margin-top: 5px;
    font-size: 12px;
    color: #ef4444;
    display: none;
    align-items: center;
    gap: 4px;
  }

  .field-error.visible {
    display: flex;
  }

  .terms-group {
    margin: 24px 0;
    padding: 16px;
    background: #f8fafc;
    border-radius: 10px;
  }

  .checkbox-item {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    margin-bottom: 12px;
    cursor: pointer;
  }

  .checkbox-item:last-child {
    margin-bottom: 0;
  }

  .checkbox-item input[type="checkbox"] {
    margin-top: 2px;
    accent-color: #4567B7;
    width: 16px;
    height: 16px;
    flex-shrink: 0;
    cursor: pointer;
  }

  .checkbox-item label {
    font-size: 13px;
    color: #374151;
    cursor: pointer;
    line-height: 1.5;
  }

  .checkbox-item label a {
    color: #4567B7;
    text-decoration: none;
    font-weight: 600;
  }

  .checkbox-item label a:hover {
    text-decoration: underline;
  }

  .btn {
    width: 100%;
    padding: 14px;
    border: none;
    border-radius: 10px;
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    font-family: 'DM Sans', sans-serif;
  }

  .btn-primary {
    background: linear-gradient(135deg, #4567B7, #2f4f9f);
    color: white;
    box-shadow: 0 4px 12px rgba(69,103,183,0.3);
  }

  .btn-primary:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 0 6px 18px rgba(69,103,183,0.4);
  }

  .btn-primary:disabled {
    opacity: 0.6;
    cursor: not-allowed;
  }

  .spinner {
    width: 16px;
    height: 16px;
    border: 2px solid rgba(255,255,255,0.3);
    border-top-color: white;
    border-radius: 50%;
    animation: spin 0.7s linear infinite;
  }

  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  .login-link {
    text-align: center;
    margin-top: 24px;
    font-size: 14px;
    color: #6b7280;
  }

  .login-link a {
    color: #4567B7;
    text-decoration: none;
    font-weight: 600;
  }

  .login-link a:hover {
    text-decoration: underline;
  }

  .blockchain-note {
    margin-top: 24px;
    padding: 12px 16px;
    background: rgba(69,103,183,0.05);
    border: 1px solid rgba(69,103,183,0.1);
    border-radius: 8px;
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 12px;
    color: #4567B7;
  }

  .role-selector {
    margin-bottom: 20px;
  }

  .role-buttons {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 8px;
    margin-top: 8px;
  }

  .role-btn {
    padding: 12px 8px;
    border: 1.5px solid #e5e7eb;
    border-radius: 8px;
    background: white;
    cursor: pointer;
    transition: all 0.2s;
    text-align: center;
  }

  .role-btn.selected {
    border-color: #4567B7;
    background: rgba(69,103,183,0.05);
    color: #4567B7;
  }

  .role-btn .role-icon {
    font-size: 20px;
    display: block;
    margin-bottom: 4px;
  }

  .role-btn .role-label {
    font-size: 11px;
    font-weight: 600;
  }

  .footer-links {
    display: flex;
    justify-content: center;
    gap: 16px;
    margin-top: 20px;
    font-size: 11px;
  }

  .footer-links a {
    color: #9ca3af;
    text-decoration: none;
    transition: color 0.2s;
  }

  .footer-links a:hover {
    color: #4567B7;
  }

  @media (max-width: 768px) {
    .register-container {
      grid-template-columns: 1fr;
    }
    .brand-panel {
      display: none;
    }
  }
</style>
</head>
<body>
<div id="app">
  <div class="register-container">
    <!-- Left Panel - Branding -->
    <div class="brand-panel">
      <div class="brand-logo" onclick="window.location.href='home.html'">
        <div class="brand-logo-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
            <path d="M12 2L4 6v6c0 5.25 3.5 10.15 8 11.5C16.5 22.15 20 17.25 20 12V6L12 2z"/>
            <path d="M9 12l2 2 4-4" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <div class="brand-logo-text">
          <h2>WISER</h2>
          <p>SECURE CLINICAL TRIALS</p>
        </div>
      </div>

      <div class="brand-content">
        <div class="brand-badge">
          <div class="brand-badge-dot"></div>
          <span>BLOCKCHAIN VERIFIED</span>
        </div>
        
        <h1 class="brand-title">Join the Future of<br>Clinical Research</h1>

        <div class="brand-features">
          <div class="brand-feature">
            <div class="feature-icon">üîó</div>
            <div class="feature-text">
              <strong>Multi-Blockchain Platform</strong>
              <span>Hyperledger Fabric ¬∑ Ethereum</span>
            </div>
          </div>
          <div class="brand-feature">
            <div class="feature-icon">üõ°Ô∏è</div>
            <div class="feature-text">
              <strong>HIPAA & 21 CFR Part 11 Compliant</strong>
              <span>Enterprise-grade security</span>
            </div>
          </div>
          <div class="brand-feature">
            <div class="feature-icon">üîê</div>
            <div class="feature-text">
              <strong>Multi-Factor Authentication</strong>
              <span>TOTP ¬∑ SMS ¬∑ FIDO2 Security Keys</span>
            </div>
          </div>
          <div class="brand-feature">
            <div class="feature-icon">üìã</div>
            <div class="feature-text">
              <strong>Immutable Audit Trail</strong>
              <span>All actions recorded on blockchain</span>
            </div>
          </div>
        </div>
      </div>

      <div class="brand-footer">
        <span>¬© 2026 WISER Health</span>
        <span>v3.2.1</span>
        <span>All Systems Operational</span>
      </div>
    </div>

    <!-- Right Panel - Registration Form -->
    <div class="form-panel">
      <div class="form-header">
        <h1>Create Account</h1>
        <p>Already have an account? <a href="login.html">Sign in</a></p>
      </div>

      <div class="error-banner" id="register-error">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2">
          <circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/>
        </svg>
        <span id="register-error-msg"></span>
      </div>

      <div class="role-selector">
        <label>Account Type <span class="required">*</span></label>
        <div class="role-buttons">
          <div class="role-btn selected" id="role-researcher" onclick="selectRole('researcher')">
            <span class="role-icon">üî¨</span>
            <span class="role-label">Researcher</span>
          </div>
          <div class="role-btn" id="role-pi" onclick="selectRole('pi')">
            <span class="role-icon">‚öïÔ∏è</span>
            <span class="role-label">Principal Investigator</span>
          </div>
          <div class="role-btn" id="role-sponsor" onclick="selectRole('sponsor')">
            <span class="role-icon">üè¢</span>
            <span class="role-label">Sponsor/Regulator</span>
          </div>
        </div>
      </div>

      <div class="form-grid">
        <div class="form-group">
          <label>First Name <span class="required">*</span></label>
          <div class="input-wrapper">
            <i>üë§</i>
            <input type="text" id="first-name" placeholder="John" />
          </div>
          <div class="field-error" id="first-name-error">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
            <span>First name is required</span>
          </div>
        </div>

        <div class="form-group">
          <label>Last Name <span class="required">*</span></label>
          <div class="input-wrapper">
            <i>üë§</i>
            <input type="text" id="last-name" placeholder="Doe" />
          </div>
          <div class="field-error" id="last-name-error">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
            <span>Last name is required</span>
          </div>
        </div>
      </div>

      <div class="form-group">
        <label>Email Address <span class="required">*</span></label>
        <div class="input-wrapper">
          <i>‚úâÔ∏è</i>
          <input type="email" id="email" placeholder="you@institution.edu" />
        </div>
        <div class="field-error" id="email-error">
          <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
          <span>Valid email is required</span>
        </div>
      </div>

      <div class="form-grid">
        <div class="form-group">
          <label>Institution <span class="required">*</span></label>
          <div class="input-wrapper">
            <i>üèõÔ∏è</i>
            <input type="text" id="institution" placeholder="University / Hospital" />
          </div>
          <div class="field-error" id="institution-error">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
            <span>Institution is required</span>
          </div>
        </div>

        <div class="form-group">
          <label>Department</label>
          <div class="input-wrapper">
            <i>üìö</i>
            <input type="text" id="department" placeholder="e.g. Cardiology" />
          </div>
        </div>
      </div>

      <div class="form-grid">
        <div class="form-group">
          <label>Password <span class="required">*</span></label>
          <div class="input-wrapper">
            <i>üîí</i>
            <input type="password" id="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
            <button class="toggle-password" onclick="togglePassword('password', this)" type="button">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/>
              </svg>
            </button>
          </div>
          <div class="field-error" id="password-error">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
            <span>Password must be at least 8 characters</span>
          </div>
        </div>

        <div class="form-group">
          <label>Confirm Password <span class="required">*</span></label>
          <div class="input-wrapper">
            <i>üîí</i>
            <input type="password" id="confirm-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
            <button class="toggle-password" onclick="togglePassword('confirm-password', this)" type="button">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/>
              </svg>
            </button>
          </div>
          <div class="field-error" id="confirm-password-error">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
            <span>Passwords must match</span>
          </div>
        </div>
      </div>

      <div class="form-group">
        <label>ORCID ID (Optional)</label>
        <div class="input-wrapper">
          <i>üÜî</i>
          <input type="text" id="orcid" placeholder="0000-0000-0000-0000" />
        </div>
      </div>

      <div class="terms-group">
        <label class="checkbox-item">
          <input type="checkbox" id="terms" />
          <label for="terms">
            I agree to the <a href="terms.html">Terms of Service</a> and <a href="privacy.html">Privacy Policy</a>. I understand that my registration and all future activities will be recorded on blockchain.
          </label>
        </label>
        <label class="checkbox-item">
          <input type="checkbox" id="communications" />
          <label for="communications">
            I wish to receive important updates about clinical trials and platform notifications.
          </label>
        </label>
      </div>

      <button class="btn btn-primary" id="register-btn" onclick="handleRegister()">
        <span class="spinner" id="register-spinner" style="display: none;"></span>
        CREATE ACCOUNT
      </button>

      <div class="login-link">
        Already have an account? <a href="login.html">Sign in</a>
      </div>

      <div class="blockchain-note">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/>
          <path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/>
        </svg>
        Your registration will be permanently logged on Hyperledger Fabric blockchain
      </div>

      <div class="footer-links">
        <a href="help.html">Help</a>
        <a href="privacy.html">Privacy</a>
        <a href="terms.html">Terms</a>
        <a href="contact.html">Contact</a>
      </div>
    </div>
  </div>
</div>

<script>
let selectedRole = 'researcher';

function selectRole(role) {
  selectedRole = role;
  document.querySelectorAll('.role-btn').forEach(btn => btn.classList.remove('selected'));
  document.getElementById(`role-${role}`).classList.add('selected');
}

function togglePassword(fieldId, btn) {
  const field = document.getElementById(fieldId);
  const icon = btn.querySelector('svg');
  
  if (field.type === 'password') {
    field.type = 'text';
    icon.innerHTML = '<path d="M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94"/><path d="M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19"/><line x1="1" y1="1" x2="23" y2="23"/>';
  } else {
    field.type = 'password';
    icon.innerHTML = '<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/>';
  }
}

function showFieldError(fieldId, errorId, show) {
  const field = document.getElementById(fieldId);
  const error = document.getElementById(errorId);
  
  if (show) {
    field.classList.add('has-error');
    error.classList.add('visible');
  } else {
    field.classList.remove('has-error');
    error.classList.remove('visible');
  }
}

function validateForm() {
  let isValid = true;
  
  const firstName = document.getElementById('first-name').value.trim();
  if (!firstName) {
    showFieldError('first-name', 'first-name-error', true);
    isValid = false;
  } else {
    showFieldError('first-name', 'first-name-error', false);
  }
  
  const lastName = document.getElementById('last-name').value.trim();
  if (!lastName) {
    showFieldError('last-name', 'last-name-error', true);
    isValid = false;
  } else {
    showFieldError('last-name', 'last-name-error', false);
  }
  
  const email = document.getElementById('email').value.trim();
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  if (!email || !emailRegex.test(email)) {
    showFieldError('email', 'email-error', true);
    isValid = false;
  } else {
    showFieldError('email', 'email-error', false);
  }
  
  const institution = document.getElementById('institution').value.trim();
  if (!institution) {
    showFieldError('institution', 'institution-error', true);
    isValid = false;
  } else {
    showFieldError('institution', 'institution-error', false);
  }
  
  const password = document.getElementById('password').value;
  if (!password || password.length < 8) {
    showFieldError('password', 'password-error', true);
    isValid = false;
  } else {
    showFieldError('password', 'password-error', false);
  }
  
  const confirmPassword = document.getElementById('confirm-password').value;
  if (password !== confirmPassword) {
    showFieldError('confirm-password', 'confirm-password-error', true);
    isValid = false;
  } else {
    showFieldError('confirm-password', 'confirm-password-error', false);
  }
  
  if (!document.getElementById('terms').checked) {
    document.getElementById('register-error').classList.add('visible');
    document.getElementById('register-error-msg').textContent = 'You must agree to the Terms of Service';
    isValid = false;
  }
  
  return isValid;
}

function generateTxHash() {
  const chars = '0123456789abcdef';
  return '0x' + Array.from({length: 64}, () => chars[Math.floor(Math.random() * 16)]).join('');
}

function delay(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

async function handleRegister() {
  if (!validateForm()) return;
  
  const btn = document.getElementById('register-btn');
  const spinner = document.getElementById('register-spinner');
  
  btn.disabled = true;
  spinner.style.display = 'inline-block';
  btn.innerHTML = '<span class="spinner" style="display: inline-block;"></span> CREATING ACCOUNT...';
  
  try {
    await delay(2000);
    
    const txHash = generateTxHash();
    
    sessionStorage.setItem('wiser-user', JSON.stringify({
      name: document.getElementById('first-name').value + ' ' + document.getElementById('last-name').value,
      email: document.getElementById('email').value,
      role: selectedRole,
      institution: document.getElementById('institution').value
    }));
    
    alert(`Account created successfully!\n\nTransaction Hash: ${txHash.substring(0, 20)}...\nYour registration has been recorded on blockchain.`);
    
    if (selectedRole === 'pi') {
      window.location.href = 'pi-dashboard.html';
    } else if (selectedRole === 'researcher') {
      window.location.href = 'researcher-dashbord.html';
    } else {
      window.location.href = 'home.html';
    }
    
  } catch (error) {
    document.getElementById('register-error').classList.add('visible');
    document.getElementById('register-error-msg').textContent = 'Registration failed. Please try again.';
    btn.disabled = false;
    spinner.style.display = 'none';
    btn.innerHTML = 'CREATE ACCOUNT';
  }
}

document.getElementById('confirm-password').addEventListener('input', function() {
  const password = document.getElementById('password').value;
  const confirm = this.value;
  
  if (confirm && password !== confirm) {
    showFieldError('confirm-password', 'confirm-password-error', true);
  } else {
    showFieldError('confirm-password', 'confirm-password-error', false);
  }
});

document.getElementById('password').addEventListener('input', function() {
  const confirm = document.getElementById('confirm-password').value;
  if (confirm && this.value !== confirm) {
    showFieldError('confirm-password', 'confirm-password-error', true);
  } else {
    showFieldError('confirm-password', 'confirm-password-error', false);
  }
});

document.addEventListener('keydown', function(e) {
  if (e.key === 'Enter') {
    handleRegister();
  }
});
</script>
</body>
</html>